var ChessboardArrows=function(l,B=2,C="rgb(50, 104, 168)",w=function(){}){function x(){h.clearRect(0,0,g.width,g.height);m.clearRect(0,0,k.width,k.height);w()}function r(a){a.strokeStyle=a.fillStyle=y;a.lineJoin="butt"}function z(a,b){a=a.getBoundingClientRect();return{x:A(b.clientX-a.left),y:A(b.clientY-a.top)}}function t(a){if(finalPoint.x==c.x){var b=Math.sign(finalPoint.y-c.y)*arrowWidth;var f=0}else finalPoint.y==c.y?(f=Math.sign(finalPoint.x-c.x)*arrowWidth,b=0):(slope_mag=Math.abs((finalPoint.y-
c.y)/(finalPoint.x-c.x)),f=Math.sign(finalPoint.x-c.x)*arrowWidth/Math.sqrt(1+Math.pow(slope_mag,2)),b=Math.sign(finalPoint.y-c.y)*Math.abs(f)*slope_mag);a.beginPath();a.lineWidth=10;a.moveTo(c.x,c.y);a.lineTo(finalPoint.x-f,finalPoint.y-b);a.stroke();var e=c.x,d=c.y;f=finalPoint.x-f;b=finalPoint.y-b;var n=arrowWidth;a.beginPath();e=Math.atan2(b-d,f-e);d=n*Math.cos(e)+f;var p=n*Math.sin(e)+b;a.moveTo(d,p);e+=1/3*2*Math.PI;d=n*Math.cos(e)+f;p=n*Math.sin(e)+b;a.lineTo(d,p);e+=1/3*2*Math.PI;d=n*Math.cos(e)+
f;p=n*Math.sin(e)+b;a.lineTo(d,p);a.closePath();a.fill()}function A(a,b){b=k.width/(8*q);return b*(Math.floor(a/b)+.5)}function u(a,b){a.style.width=a.style.width||a.width+"px";a.style.height=a.style.height||a.height+"px";a.width=Math.ceil(a.width*b);a.height=Math.ceil(a.height*b);a=a.getContext("2d");a.scale(b,b);return a}var q=B;var y=C;var g=document.getElementById("drawing-canvas");var h=u(g,q);r(h);var k=document.getElementById("primary-canvas");var m=u(k,q);r(m);l=document.getElementById(l);
l.addEventListener("mousedown",a=>{if(3==a.which){v=!0;c=finalPoint=z(g,a);a=h;var b=c.x,f=c.y,e=k.width/(16*q)-1;a.beginPath();a.lineWidth=4;a.arc(b,f,e,0,2*Math.PI);a.stroke()}});l.addEventListener("mouseup",a=>{if(3==a.which){v=!1;if(c.x==finalPoint.x&&c.y==finalPoint.y){a=m;var b=c.x,f=c.y,e=k.width/(16*q)-1;a.beginPath();a.lineWidth=4;a.arc(b,f,e,0,2*Math.PI);a.stroke()}else t(m);h.clearRect(0,0,g.width,g.height)}else 1==a.which&&x()});l.addEventListener("mousemove",a=>{finalPoint=z(g,a);!v||
c.x==finalPoint.x&&c.y==finalPoint.y||(h.clearRect(0,0,g.width,g.height),t(h))});l.addEventListener("contextmenu",a=>a.preventDefault(),!1);var c={x:null,y:null};finalPoint={x:null,y:null};arrowWidth=18;var v=!1;return{drawArrowFromSquare:function(a,b,f){var e="abcdefgh".split(""),d=parseInt(k.style.width)/8;c.y=(8-parseInt(a.charAt(1),10))*d+d/2;finalPoint.y=(8-parseInt(b.charAt(1),10))*d+d/2;"black"==f&&(e.reverse(),c.y=parseInt(a.charAt(1),10)*d-d/2,finalPoint.y=parseInt(b.charAt(1),10)*d-d/2);
c.x=e.indexOf(a.charAt(0))*d+d/2;finalPoint.x=e.indexOf(b.charAt(0))*d+d/2;t(m)},clear:x,onClear:w,changeResolution:u,setContextStyle:r,setColour:function(a,b){y=a;r(b)},primaryContext:m,drawContext:h}};
